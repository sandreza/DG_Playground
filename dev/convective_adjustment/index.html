<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Convective Adjustment · DG_Playground</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">DG_Playground</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Discontinuous Galerkin</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../dg_methods/">Home</a></li><li><a class="tocitem" href="../dg_single_element/">Single Element</a></li><li><a class="tocitem" href="../boundary_conditions/">Boundary Conditions</a></li><li><a class="tocitem" href="../inexact_quadrature/">Variational Crimes</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../physics/">Home</a></li><li class="is-active"><a class="tocitem" href>Convective Adjustment</a><ul class="internal"><li><a class="tocitem" href="#Mathematical-Form"><span>Mathematical Form</span></a></li><li><a class="tocitem" href="#Typical-Time-Discretization"><span>Typical Time-Discretization</span></a></li><li><a class="tocitem" href="#Simplification"><span>Simplification</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../function_index/">Function Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Physics</a></li><li class="is-active"><a href>Convective Adjustment</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Convective Adjustment</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sandreza/DG_Playground/blob/master/docs/src/convective_adjustment.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Convective-Adjustment"><a class="docs-heading-anchor" href="#Convective-Adjustment">Convective Adjustment</a><a id="Convective-Adjustment-1"></a><a class="docs-heading-anchor-permalink" href="#Convective-Adjustment" title="Permalink"></a></h1><p>Convective adjustment is a simple parameterization that attempts the capture the effect of mixing due to <a href="https://en.wikipedia.org/wiki/Convection">convection</a>. Physically this occurs because dense water parcels tend to sink and and light water parcels tend to rise.</p><h2 id="Mathematical-Form"><a class="docs-heading-anchor" href="#Mathematical-Form">Mathematical Form</a><a id="Mathematical-Form-1"></a><a class="docs-heading-anchor-permalink" href="#Mathematical-Form" title="Permalink"></a></h2><p>Typically the effect of convective adjustment is captured via a nonlinear diffusivity such as</p><div>\[\begin{aligned}
\kappa_{zz}(\rho) = \begin{cases}
\kappa_1 &amp; \text{ if }\text{ }  \partial_z \rho &lt; 0
\\
\kappa_2 &amp; \text{ otherwise}
\end{cases}
\end{aligned}\]</div><p>where <span>$\kappa_1 \gg \kappa_2$</span>, <span>$z$</span> is aligned with the direction of gravity, and <span>$\kappa_{zz}$</span> is the <span>$zz$</span> component of the diffusivity tensor <span>$\kappa$</span>,</p><div>\[\begin{aligned}
\kappa(\rho) = \begin{bmatrix}
\kappa_{xx} &amp; \kappa_{xy} &amp; 0 \\ 
\kappa_{yx} &amp; \kappa_{yy} &amp; 0 \\ 
0 &amp; 0 &amp; \kappa_{zz}
\end{bmatrix}
\end{aligned}.\]</div><p>Thinking of <span>$\rho$</span> as density, a simple parameterization of convection is of the form</p><div>\[\begin{aligned}
\partial_t \rho &amp;= \nabla \cdot \left[ \kappa(\rho) \cdot \nabla \rho \right]
\end{aligned},\]</div><p>Intuitively, the above nonlinear diffusivity models the effect of mixing when heavy fluid parcels overlie light fluid parcels. Here the  mixing is modeled via diffusion with a large diffusivity constant. This is by no means the only way to model the effect of mixing, but it is a starting point.</p><h2 id="Typical-Time-Discretization"><a class="docs-heading-anchor" href="#Typical-Time-Discretization">Typical Time-Discretization</a><a id="Typical-Time-Discretization-1"></a><a class="docs-heading-anchor-permalink" href="#Typical-Time-Discretization" title="Permalink"></a></h2><p>Letting,</p><div>\[\begin{aligned}
\kappa_H(\rho) = \begin{bmatrix}
\kappa_{xx} &amp; \kappa_{xy} \\ 
\kappa_{yx} &amp; \kappa_{yy} \\ 
\end{bmatrix}
\end{aligned},\]</div><p>a typical time-discretization would be</p><div>\[\begin{aligned}
\rho^{n+1} - \Delta t \partial_z \left[ \kappa_{zz}(\rho^{n}) \partial_z \rho^{n+1} \right] &amp;= \rho^{n} + \Delta t \left( f^n + \nabla^H \cdot \left[ \kappa_H(\rho^n) \cdot \nabla^H \rho^n \right] \right)
\end{aligned}\]</div><p>where the forcing function <span>$f^n$</span> comes from boundary condition and we have split the gradient operator into the vertically aligned component <span>$z$</span> and the other (horizontal) directions. When discretized, the time-stepping method yields a <a href="https://en.wikipedia.org/wiki/Helmholtz_equation">Helmholtz</a>-like problem that needs to be solved every timestep. The reason why it is not exactly a Helmholtz-like problem is due to the use of inexact quadrature for variable diffusivity. In this context, inexact quadrature means that, instead of projecting nonlinear terms onto the appropriate basis, we multiply them together at the collocation points.</p><h2 id="Simplification"><a class="docs-heading-anchor" href="#Simplification">Simplification</a><a id="Simplification-1"></a><a class="docs-heading-anchor-permalink" href="#Simplification" title="Permalink"></a></h2><p>There are a wide variety of functional forms that <span>$\kappa(\rho^n)$</span> can take on, but typically it is similar to</p><div>\[\begin{aligned}
    \kappa_{zz}(\rho^n) \approx
    \begin{cases}
    \kappa_1 &amp; \text{ if } z &gt; h \\
    \kappa_2 &amp; \text{ if } z \leq h
    \end{cases}
\end{aligned}\]</div><p>where <span>$z \in [0, L]$</span> and <span>$h$</span> can take on all values between <span>$[0, L]$</span> and varies depending on the horizontal components. The reason why there is usually just one place that <span>$\kappa_{zz}$</span> changes values of diffusivity has to do with typical physical scenarios that arise in the ocean / atmosphere. The ocean interior is stably stratified. Cooling comes from the surface of the ocean and leads to mixing that starts in the upper ocean and progresses towards the ocean abyss. The solution to linear systems of this form (when <span>$\Delta t$</span> becomes large), is essentially constant in the region of high diffusivity.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../physics/">« Home</a><a class="docs-footer-nextpage" href="../function_index/">Function Index »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 22 November 2020 17:00">Sunday 22 November 2020</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
